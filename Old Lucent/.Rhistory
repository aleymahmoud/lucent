# Check if data needs differencing
ndiffs(ts_data)  # Regular differencing
nsdiffs(ts_data)  # Seasonal differencing
# Plot ACF and PACF to identify potential ARIMA parameters
par(mfrow=c(1,2))
acf(ts_data, main="ACF of Original Series")
pacf(ts_data, main="PACF of Original Series")
par(mfrow=c(1,1))
# If differencing is needed, apply and check again
if(ndiffs(ts_data) > 0 || nsdiffs(ts_data) > 0) {
# Apply regular differencing if needed
if(ndiffs(ts_data) > 0) {
d <- ndiffs(ts_data)
diff_data <- diff(ts_data, differences = d)
# Plot differenced series
autoplot(diff_data) +
ggtitle(paste0("Differenced Series (d=", d, ")")) +
theme_minimal()
# Plot ACF and PACF of differenced series
par(mfrow=c(1,2))
acf(diff_data, main=paste0("ACF of Differenced Series (d=", d, ")"))
pacf(diff_data, main=paste0("PACF of Differenced Series (d=", d, ")"))
par(mfrow=c(1,1))
}
# Apply seasonal differencing if needed
if(nsdiffs(ts_data) > 0) {
D <- nsdiffs(ts_data)
seas_diff_data <- diff(ts_data, lag=frequency(ts_data), differences=D)
# Plot seasonally differenced series
autoplot(seas_diff_data) +
ggtitle(paste0("Seasonally Differenced Series (D=", D, ")")) +
theme_minimal()
# Plot ACF and PACF of seasonally differenced series
par(mfrow=c(1,2))
acf(seas_diff_data, main=paste0("ACF of Seasonally Differenced Series (D=", D, ")"))
pacf(seas_diff_data, main=paste0("PACF of Seasonally Differenced Series (D=", D, ")"))
par(mfrow=c(1,1))
}
}
# -------------------------- ARIMA MODELING ----------------------
# Automatic ARIMA model selection
auto_arima <- auto.arima(ts_data, seasonal=TRUE,
stepwise=TRUE, approximation=FALSE)
summary(auto_arima)
# Check residuals
checkresiduals(auto_arima)
# Box-Ljung test for residual autocorrelation
Box.test(residuals(auto_arima), lag=24, type="Ljung-Box")
# -------------------------- FORECASTING -----------------------
# Generate forecasts (h is the forecast horizon)
forecast_horizon <- 12  # 12 months ahead
arima_forecast <- forecast(auto_arima, h=forecast_horizon)
# Plot forecast
autoplot(arima_forecast) +
ggtitle("ARIMA Forecast for Retail Sales") +
xlab("Year") +
ylab("Sales") +
theme_minimal()
# R Script for ARIMA Modeling on Retail Data
# Install required packages if not already installed
if (!require("forecast")) install.packages("forecast")
if (!require("tseries")) install.packages("tseries")
if (!require("ggplot2")) install.packages("ggplot2")
if (!require("readxl")) install.packages("readxl")
if (!require("dplyr")) install.packages("dplyr")
if (!require("lubridate")) install.packages("lubridate")
# Load libraries
library(forecast)
library(tseries)
library(ggplot2)
library(readxl)
library(dplyr)
library(lubridate)
# Set working directory (modify as needed)
# setwd("/path/to/your/directory")
# -------------------------- DATA IMPORT ---------------------------
# Option 1: Import CSV file
# retail_data <- read.csv("retail_sales.csv")
# Option 2: Import Excel file
# retail_data <- read_excel("retail_sales.xlsx")
# Sample data creation (remove this when using real data)
retail_data <- readxl::read_excel('c:/Users/aleym/Desktop/Forecast Data Sample.xlsx')
retail_data <- retail_data %>%  dplyr::select(Date,Volume)
# -------------------------- DATA PREPARATION ---------------------
# Convert to time series object
# Adjust the frequency based on your data:
# 12 for monthly, 52 for weekly, 365 for daily
ts_data <- ts(retail_data$Volume, frequency=12,
start=c(year(retail_data$Date[1]), month(retail_data$Date[1])))
# Plot the original time series
autoplot(ts_data) +
ggtitle("Retail Sales Time Series") +
xlab("Year") +
ylab("Sales") +
theme_minimal()
# -------------------------- DATA EXPLORATION --------------------
# Decompose the time series to understand patterns
decomp <- stl(ts_data, s.window="periodic")
autoplot(decomp) +
ggtitle("Seasonal Decomposition of Retail Sales")
# Check for stationarity using Augmented Dickey-Fuller test
adf_test <- adf.test(ts_data)
print(adf_test)
# Check if data needs differencing
ndiffs(ts_data)  # Regular differencing
nsdiffs(ts_data)  # Seasonal differencing
# Plot ACF and PACF to identify potential ARIMA parameters
par(mfrow=c(1,2))
acf(ts_data, main="ACF of Original Series")
pacf(ts_data, main="PACF of Original Series")
par(mfrow=c(1,1))
# If differencing is needed, apply and check again
if(ndiffs(ts_data) > 0 || nsdiffs(ts_data) > 0) {
# Apply regular differencing if needed
if(ndiffs(ts_data) > 0) {
d <- ndiffs(ts_data)
diff_data <- diff(ts_data, differences = d)
# Plot differenced series
autoplot(diff_data) +
ggtitle(paste0("Differenced Series (d=", d, ")")) +
theme_minimal()
# Plot ACF and PACF of differenced series
par(mfrow=c(1,2))
acf(diff_data, main=paste0("ACF of Differenced Series (d=", d, ")"))
pacf(diff_data, main=paste0("PACF of Differenced Series (d=", d, ")"))
par(mfrow=c(1,1))
}
# Apply seasonal differencing if needed
if(nsdiffs(ts_data) > 0) {
D <- nsdiffs(ts_data)
seas_diff_data <- diff(ts_data, lag=frequency(ts_data), differences=D)
# Plot seasonally differenced series
autoplot(seas_diff_data) +
ggtitle(paste0("Seasonally Differenced Series (D=", D, ")")) +
theme_minimal()
# Plot ACF and PACF of seasonally differenced series
par(mfrow=c(1,2))
acf(seas_diff_data, main=paste0("ACF of Seasonally Differenced Series (D=", D, ")"))
pacf(seas_diff_data, main=paste0("PACF of Seasonally Differenced Series (D=", D, ")"))
par(mfrow=c(1,1))
}
}
# -------------------------- ARIMA MODELING ----------------------
# Automatic ARIMA model selection
auto_arima <- auto.arima(ts_data, seasonal=TRUE,
stepwise=TRUE, approximation=FALSE)
summary(auto_arima)
# Manual ARIMA model specification (uncomment and modify as needed)
# Notation: ARIMA(p,d,q)(P,D,Q)[m] where m is the seasonal period
# p, P = AR order; d, D = differencing; q, Q = MA order
# manual_arima <- Arima(ts_data, order=c(1,1,1), seasonal=c(1,1,1))
# summary(manual_arima)
# -------------------------- MODEL DIAGNOSTICS ------------------
# Check residuals
checkresiduals(auto_arima)
# Box-Ljung test for residual autocorrelation
Box.test(residuals(auto_arima), lag=24, type="Ljung-Box")
# -------------------------- FORECASTING -----------------------
# Generate forecasts (h is the forecast horizon)
forecast_horizon <- 7  # 12 months ahead
arima_forecast <- forecast(auto_arima, h=forecast_horizon)
# Plot forecast
autoplot(arima_forecast) +
ggtitle("ARIMA Forecast for Retail Sales") +
xlab("Year") +
ylab("Sales") +
theme_minimal()
# Load required libraries
library(forecast)
library(ggplot2)
library(readxl) # For reading Excel files
# Read data with your specific path
data <- readxl::read_excel('c:/Users/aleym/Desktop/Forecast Data Sample.xlsx')
# Prepare time series data
data$Date <- as.Date(data$Date)
ts_data <- ts(data$Volume, frequency=7)  # Daily data with weekly seasonality
# Fit ARIMA model
arima_model <- auto.arima(ts_data)
# Generate forecast for next 7 days
forecast_result <- forecast(arima_model, h=7)
# Print results
cat("ARIMA Model Summary:\n")
print(summary(arima_model))
cat("\nForecast for next 7 days:\n")
print(forecast_result)
# Plot forecast
plot(forecast_result, main="Daily Sales Forecast - Next 7 Days",
xlab="Time", ylab="Volume")
# Load required libraries
library(forecast)
library(ggplot2)
library(readxl)
# Read data with your specific path
data <- readxl::read_excel('c:/Users/aleym/Desktop/Forecast Data Sample.xlsx')
# Prepare time series data
data$Date <- as.Date(data$Date)
ts_data <- ts(data$Volume, frequency=7)  # Daily data with weekly seasonality
# Fit SARIMA model (Seasonal ARIMA)
sarima_model <- auto.arima(ts_data, seasonal=TRUE, D=1)  # Forcing seasonal differencing
# Generate forecast for next 7 days
forecast_result <- forecast(sarima_model, h=7)
# Print results
cat("SARIMA Model Summary:\n")
print(summary(sarima_model))
cat("\nForecast for next 7 days:\n")
print(forecast_result)
# Plot forecast
plot(forecast_result, main="Daily Sales Forecast - SARIMA - Next 7 Days",
xlab="Time", ylab="Volume")
datatable(forecast_result)
datatable(data = forecast_result)
forecast_result
# Load required libraries
library(forecast)
library(ggplot2)
library(readxl)
library(DT)  # For interactive datatable
# Read data with your specific path
data <- readxl::read_excel('c:/Users/aleym/Desktop/Forecast Data Sample.xlsx')
# Prepare time series data
data$Date <- as.Date(data$Date)
# Assuming you have exogenous variables in your dataset
# If not, you'll need to create or import them
# For example, day of week as exogenous variable
data$DayOfWeek <- as.factor(weekdays(data$Date))
data$WeekNumber <- as.numeric(format(data$Date, "%V"))
# Create dummy variables for day of week (exogenous variables)
day_dummies <- model.matrix(~ DayOfWeek - 1, data=data)
colnames(day_dummies) <- paste0("Day_", colnames(day_dummies))
xreg_data <- cbind(day_dummies, WeekNumber=data$WeekNumber)
# Create future exogenous data for forecasting
future_dates <- seq(max(data$Date) + 1, by="day", length.out=7)
future_days <- as.factor(weekdays(future_dates))
future_weeks <- as.numeric(format(future_dates, "%V"))
future_day_dummies <- model.matrix(~ future_days - 1)
colnames(future_day_dummies) <- paste0("Day_", levels(as.factor(weekdays(data$Date))))
future_xreg <- cbind(future_day_dummies, WeekNumber=future_weeks)
colnames(future_xreg) <- colnames(xreg_data)
# Convert to time series
ts_data <- ts(data$Volume, frequency=7)
# Fit SARIMAX model (Seasonal ARIMA with exogenous variables)
sarimax_model <- auto.arima(ts_data, xreg=xreg_data, seasonal=TRUE)
datatable(forecast_df, options = list(pageLength = 7))
# Load required libraries
library(forecast)
library(ggplot2)
library(readxl)
library(DT)  # For interactive datatable
# Read data with your specific path
data <- readxl::read_excel('c:/Users/aleym/Desktop/Forecast Data Sample.xlsx')
# Prepare time series data
data$Date <- as.Date(data$Date)
# Assuming you have exogenous variables in your dataset
# If not, you'll need to create or import them
# For example, day of week as exogenous variable
data$DayOfWeek <- as.factor(weekdays(data$Date))
data$WeekNumber <- as.numeric(format(data$Date, "%V"))
# Create dummy variables for day of week (exogenous variables)
day_dummies <- model.matrix(~ DayOfWeek - 1, data=data)
colnames(day_dummies) <- paste0("Day_", colnames(day_dummies))
xreg_data <- cbind(day_dummies, WeekNumber=data$WeekNumber)
# Create future exogenous data for forecasting
future_dates <- seq(max(data$Date) + 1, by="day", length.out=7)
future_days <- as.factor(weekdays(future_dates))
future_weeks <- as.numeric(format(future_dates, "%V"))
future_day_dummies <- model.matrix(~ future_days - 1)
colnames(future_day_dummies) <- paste0("Day_", levels(as.factor(weekdays(data$Date))))
future_xreg <- cbind(future_day_dummies, WeekNumber=future_weeks)
colnames(future_xreg) <- colnames(xreg_data)
# Convert to time series
ts_data <- ts(data$Volume, frequency=7)
# Fit SARIMAX model (Seasonal ARIMA with exogenous variables)
sarimax_model <- auto.arima(ts_data, xreg=xreg_data, seasonal=TRUE)
# Load required libraries
library(forecast)
library(ggplot2)
library(readxl)
library(DT)  # For interactive datatable
# Read data with your specific path
data <- readxl::read_excel('c:/Users/aleym/Desktop/Forecast Data Sample.xlsx')
# Prepare time series data
data$Date <- as.Date(data$Date)
# Assuming you have exogenous variables in your dataset
# If not, you'll need to create or import them
# For example, day of week as exogenous variable
data$DayOfWeek <- as.factor(weekdays(data$Date))
data$WeekNumber <- as.numeric(format(data$Date, "%V"))
# Create dummy variables for day of week (exogenous variables)
day_dummies <- model.matrix(~ DayOfWeek - 1, data=data)
colnames(day_dummies) <- paste0("Day_", colnames(day_dummies))
xreg_data <- cbind(day_dummies, WeekNumber=data$WeekNumber)
# Create future exogenous data for forecasting
future_dates <- seq(max(data$Date) + 1, by="day", length.out=7)
future_days <- as.factor(weekdays(future_dates))
future_weeks <- as.numeric(format(future_dates, "%V"))
future_day_dummies <- model.matrix(~ future_days - 1)
colnames(future_day_dummies) <- paste0("Day_", levels(as.factor(weekdays(data$Date))))
future_xreg <- cbind(future_day_dummies, WeekNumber=future_weeks)
colnames(future_xreg) <- colnames(xreg_data)
# Convert to time series
ts_data <- ts(data$Volume, frequency=7)
# Fit SARIMAX model (Seasonal ARIMA with exogenous variables)
sarimax_model <- auto.arima(ts_data, xreg=xreg_data, seasonal=TRUE)
# Load required libraries
library(forecast)
library(ggplot2)
library(readxl)
library(DT)  # For interactive datatable
# Read data with your specific path
data <- readxl::read_excel('c:/Users/aleym/Desktop/Forecast Data Sample.xlsx')
# Prepare time series data
data$Date <- as.Date(data$Date)
# Assuming you have exogenous variables in your dataset
# If not, you'll need to create or import them
# For example, day of week as exogenous variable
data$DayOfWeek <- as.factor(weekdays(data$Date))
data$WeekNumber <- as.numeric(format(data$Date, "%V"))
# Create dummy variables for day of week (exogenous variables)
day_dummies <- model.matrix(~ DayOfWeek - 1, data=data)
colnames(day_dummies) <- paste0("Day_", colnames(day_dummies))
xreg_data <- cbind(day_dummies, WeekNumber=data$WeekNumber)
# Create future exogenous data for forecasting
future_dates <- seq(max(data$Date) + 1, by="day", length.out=7)
future_days <- as.factor(weekdays(future_dates))
future_weeks <- as.numeric(format(future_dates, "%V"))
future_day_dummies <- model.matrix(~ future_days - 1)
colnames(future_day_dummies) <- paste0("Day_", levels(as.factor(weekdays(data$Date))))
future_xreg <- cbind(future_day_dummies, WeekNumber=future_weeks)
colnames(future_xreg) <- colnames(xreg_data)
# Convert to time series
ts_data <- ts(data$Volume, frequency=7)
# Fit SARIMAX model (Seasonal ARIMA with exogenous variables)
sarimax_model <- auto.arima(ts_data, xreg=xreg_data, seasonal=TRUE)
# Load required libraries
library(forecast)
library(ggplot2)
library(readxl)
library(DT)  # For interactive datatable
# Read data with your specific path
data <- readxl::read_excel('c:/Users/aleym/Desktop/Forecast Data Sample.xlsx')
# Prepare time series data
data$Date <- as.Date(data$Date)
# Assuming you have exogenous variables in your dataset
# If not, you'll need to create or import them
# For example, day of week as exogenous variable
data$DayOfWeek <- as.factor(weekdays(data$Date))
data$WeekNumber <- as.numeric(format(data$Date, "%V"))
# Create dummy variables for day of week (exogenous variables)
day_dummies <- model.matrix(~ DayOfWeek - 1, data=data)
colnames(day_dummies) <- paste0("Day_", colnames(day_dummies))
xreg_data <- cbind(day_dummies, WeekNumber=data$WeekNumber)
# Create future exogenous data for forecasting
future_dates <- seq(max(data$Date) + 1, by="day", length.out=7)
future_days <- as.factor(weekdays(future_dates))
future_weeks <- as.numeric(format(future_dates, "%V"))
future_day_dummies <- model.matrix(~ future_days - 1)
colnames(future_day_dummies) <- paste0("Day_", levels(as.factor(weekdays(data$Date))))
future_xreg <- cbind(future_day_dummies, WeekNumber=future_weeks)
colnames(future_xreg) <- colnames(xreg_data)
# Convert to time series
ts_data <- ts(data$Volume, frequency=7)
# Fit SARIMAX model (Seasonal ARIMA with exogenous variables)
sarimax_model <- auto.arima(ts_data, xreg=xreg_data, seasonal=TRUE)
# Load required libraries
library(forecast)
library(ggplot2)
library(readxl)
library(DT)  # For interactive datatable
# Read data with your specific path
data <- readxl::read_excel('c:/Users/aleym/Desktop/Forecast Data Sample.xlsx')
# Prepare time series data
data$Date <- as.Date(data$Date)
# Assuming you have exogenous variables in your dataset
# If not, you'll need to create or import them
# For example, day of week as exogenous variable
data$DayOfWeek <- as.factor(weekdays(data$Date))
data$WeekNumber <- as.numeric(format(data$Date, "%V"))
# Create dummy variables for day of week (exogenous variables)
day_dummies <- model.matrix(~ DayOfWeek - 1, data=data)
colnames(day_dummies) <- paste0("Day_", colnames(day_dummies))
xreg_data <- cbind(day_dummies, WeekNumber=data$WeekNumber)
# Create future exogenous data for forecasting
future_dates <- seq(max(data$Date) + 1, by="day", length.out=7)
future_days <- as.factor(weekdays(future_dates))
future_weeks <- as.numeric(format(future_dates, "%V"))
future_day_dummies <- model.matrix(~ future_days - 1)
colnames(future_day_dummies) <- paste0("Day_", levels(as.factor(weekdays(data$Date))))
future_xreg <- cbind(future_day_dummies, WeekNumber=future_weeks)
colnames(future_xreg) <- colnames(xreg_data)
# Convert to time series
ts_data <- ts(data$Volume, frequency=7)
# Fit SARIMAX model (Seasonal ARIMA with exogenous variables)
sarimax_model <- auto.arima(ts_data, xreg=xreg_data, seasonal=TRUE)
# Load required libraries
library(forecast)
library(ggplot2)
library(readxl)
library(DT)
# Read data with your specific path
data <- readxl::read_excel('c:/Users/aleym/Desktop/Forecast Data Sample.xlsx')
# Prepare time series data
data$Date <- as.Date(data$Date)
# Create exogenous variables - using fewer dummy variables to avoid rank deficiency
# Create day of week numeric (1-7)
data$DayOfWeek <- as.numeric(format(data$Date, "%u"))
# Create xreg matrix with just numeric variables
xreg_data <- cbind(
DayOfWeek = data$DayOfWeek,
WeekNumber = as.numeric(format(data$Date, "%V"))
)
# Create future exogenous data for forecasting
future_dates <- seq(max(data$Date) + 1, by="day", length.out=7)
future_xreg <- cbind(
DayOfWeek = as.numeric(format(future_dates, "%u")),
WeekNumber = as.numeric(format(future_dates, "%V"))
)
colnames(future_xreg) <- colnames(xreg_data)
# Convert to time series
ts_data <- ts(data$Volume, frequency=7)
# Fit SARIMAX model (Seasonal ARIMA with exogenous variables)
sarimax_model <- auto.arima(ts_data, xreg=xreg_data, seasonal=TRUE)
# Generate forecast for next 7 days with exogenous variables
forecast_result <- forecast(sarimax_model, h=7, xreg=future_xreg)
# Print results
cat("SARIMAX Model Summary:\n")
print(summary(sarimax_model))
cat("\nForecast for next 7 days:\n")
print(forecast_result)
# Plot forecast
plot(forecast_result, main="SARIMAX Forecast - Next 7 Days",
xlab="Time", ylab="Volume")
# Create forecast data frame for display
forecast_df <- data.frame(
Date = future_dates,
Day = weekdays(future_dates),
Forecast = round(forecast_result$mean, 2),
Lower_95 = round(forecast_result$lower[,2], 2),
Upper_95 = round(forecast_result$upper[,2], 2)
)
# Display original data in datatable
datatable(head(data, 20), options = list(pageLength = 10, scrollX = TRUE),
caption = "Original Data (First 20 Rows)")
# Display forecast in datatable
datatable(forecast_df, options = list(pageLength = 7, scrollX = TRUE),
caption = "7-Day Sales Forecast")
# Load required libraries
library(forecast)
library(ggplot2)
library(readxl)
library(DT)
# Read data with your specific path
data <- readxl::read_excel('c:/Users/aleym/Desktop/Forecast Data Sample.xlsx')
# Prepare time series data
data$Date <- as.Date(data$Date)
ts_data <- ts(data$Volume, frequency=7)  # Daily data with weekly seasonality
# Fit ETS model (Exponential Smoothing)
ets_model <- ets(ts_data)
# Generate forecast for next 7 days
forecast_result <- forecast(ets_model, h=7)
# Print results
cat("ETS Model Summary:\n")
print(summary(ets_model))
cat("\nForecast for next 7 days:\n")
print(forecast_result)
# Plot forecast
plot(forecast_result, main="ETS Forecast - Next 7 Days",
xlab="Time", ylab="Volume")
# Create forecast data frame for display
future_dates <- seq(max(data$Date) + 1, by="day", length.out=7)
forecast_df <- data.frame(
Date = future_dates,
Day = weekdays(future_dates),
Forecast = round(forecast_result$mean, 2),
Lower_95 = round(forecast_result$lower[,2], 2),
Upper_95 = round(forecast_result$upper[,2], 2)
)
# Display original data in datatable
datatable(head(data, 20), options = list(pageLength = 10, scrollX = TRUE),
caption = "Original Data (First 20 Rows)")
# Display forecast in datatable
datatable(forecast_df, options = list(pageLength = 7, scrollX = TRUE),
caption = "7-Day Sales Forecast (ETS)")
runApp()
shiny::runApp()
?prophet
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
paste0("background-color:", bg_color, ";")
paste0("background-color:", '#2196F3', ";")
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp('D:/Projects/Lucent2')
